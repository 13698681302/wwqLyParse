# 格式解析

本方法主要是根据输入的内容（网址），进行分析并返回实际视频格式信息或视频网址列表。其函数原型为  
`def Parse(input, types = None )
`   
**功能说明：**   
解析用户输入的字符串，返回解析结果。
* input : 单行字符串，用户输入的内容，可能是网址、文字等
* types : None 或者字符串数组，用于表示要返回的内容，如果为 None 则返回所有可能值，为字符串数组则只返回指定类型的内容。如 ["formats"] 表示只需要返回视频格式信息

根据用户输入，插件可自行选择解析模式，返回若干个解析结果，结果放到一个数组中，对于只有一项结果的情况可以返回一个 dict 。支持的结果类型有：

**视频格式解析**
```
[  
     {  
        "type" : "formats",
        "name" : "",   
        "icon" : "http://xxx.cn/xxx.jpg",
        "provider" : "视频网站名称",
        "caption" : "标题",
        "warning" : "提示信息"，
        "sorted" ： 1,
        "data" : [  
            {  
                "label" : "",   
                "code" : "",
                "ext" : "",   
                "size" : "",
                "type" : "vide/mpeg",
                "download" : [ ... ]
            }  
        ]  
     }  
]  
```
* type 单行文本，必有， 为 formats
* name 单行文本，必有，视频的名称
* icon 单行文本，可选，视频图标网址，必须为 http 或 https 
* provider 单行文本，可选，视频提供者（视频网站）的名称
* caption 单行文本，可选，在该输入同时有多种解析结果时，使用该字符串作为 Tab 页的名称，默认为 “视频”
* warning 单行文本，可选，提示内容，在解析结果的下方以突出方式显示，用于向用户说明一些信息
* sorted 布尔值，可选，默认为 False，为 True 表示 data 中的内容已经做过排序，不需要对其进行排序
* data 数组，用于描述可以解析出来的视频格式信息：  

>* label : 单行文本，格式的文字表示
>* code : 单行文本，可选，格式的内部表示，用于调用 ParseURL 时使用，若没设定该值则使用 label 的值来调用 ParseURL
>* ext : 单行文本，可选，默认扩展名，建议提供，若如则根据下载过程网站返回信息来计算扩展名
>* size : 单行文本，可选，视频总大小的字符串表示
>* type : 单行文本，可选，对应内容的 mime type，若无则按 video/* 处理
>* download ：数组，实际下载信息，具体格式参见 [[ParseURL]]，如果直接提供实际网址则下载时不再调用 ParseURL。

**视频列表**  
主要用于解析连续剧、动漫、综艺的全部网址时使用，具体格式为
```
{
     "type" : "list", 
     "title" : "", 
     "data" : [
         {
            "no" : "", 
            "subtitle" : "", 
            "url" : "" 
         }
         ......
     ], 
     "formats" : [
         {
                "label" : "", 
                "code" : "",
                "ext" : "" 
         }
         ......
     ],
      "formatsSorted" : 1
}
```
* type : 单行文本，必须为 list
* title : 单行文本，必选，剧集的名称，
* data : 数组(list, [], Array)，每集视频的信息，数组内容为若干 dict({}, object)。每个 dict 对于一集视频。每个 dict 包含的信息有： 

>* no 类型：单行文本，可选，能简短将视频区别出来的字符串，如第X集。但与 subtitle 两者至少有一项
>* subtitle 单行文本，可选，本集信息的简单介绍
>* url 类型：单行文本，必选，本集信息的实际播放网址

* formats : (可选) 类型：数组(list, [], array)，为视频的可选格式列表，内容为若干 dict，其内容与前面视频格式信息中的定义一样，由于是针对所有视频的，因此只需要包含 label、code、 ext 等信息。若没指定该项，如果当前返回有 formats 类型的，则直接使用 formats 类型中的相关信息。如果没有，则会使用 data 中的第一项网址再次调用  Parse 来获取格式信息
* formatsSorted ： （可选）类型：布尔值，如果 formats 中的内容已经排序，则指定该值并设为 True

**视频网址集**

主要用于提取出一些没有直接关系的网址，具体格式为
```
{
     "type" : "collection", 
     "title" : "", 
     "data" : [
         {
            "no" : "", 
            "subtitle" : "", 
            "unsure" : True,
            "url" : "" 
         }
         ......
     ]
}
```
* type : 单行文本，必须为 collection
* title : 本组视频网址的标题
* data : 数组(list, [], Array)，每集视频的信息，数组内容为若干 dict({}, object)。每个 dict 对于一集视频。每个 dict 包含的信息有： 

>* no 类型：单行文本，可选，能简短将视频区别出来的字符串，如第X集。但与 subtitle 两者至少有一项
>* subtitle 单行文本，可选，本集信息的简单介绍
>* unsure 布尔值，可选，默认为 False，为 True 表示不确定是视频网址，则默认不会选中
>* url 类型：单行文本，必选，本集信息的实际播放网址，对于得到的就是实际视频网址的情况，需要采用特殊格式表示，即采用 direct: 开头，后面包含内容分为别为 格式名称、视频名称、视频网址，三者之间使用 | 来分隔。
```
direct:label|title|url
```
其中：
label : 格式名称，如高清_MP4；
title : 视频名称；
url : 要下载的网址；

**错误信息**

```
{
     "type" : "error", 
     "error" : "错误说明", 
     "detail" : "错误的详细描述"
}
```
* type : 单行文本 可选，若指定则必须为 error
* error : 多行文本，必选，对错误信息的描述
* detail : 多行文本，可选，对错误的详细描述
